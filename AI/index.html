<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Multilingual Speech & Text to English</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            padding-top: 50px;
        }
        select, button, textarea {
            padding: 10px 20px;
            font-size: 1em;
            margin: 10px;
            cursor: pointer;
        }
        #output, #translation {
            margin-top: 20px;
            font-size: 1.2em;
            border: 1px solid #ccc;
            padding: 10px;
            width: 60%;
            margin-left: auto;
            margin-right: auto;
            min-height: 50px;
        }
        textarea {
            width: 60%;
            height: 80px;
        }
    </style>
</head>
<body>
    <h1>Multilingual Speech & Text to English</h1>

    <p>Select your language:</p>
    <select id="language">
        <option value="en">English</option>
        <option value="hi">Hindi</option>
        <option value="ta">Tamil</option>
        <option value="te">Telugu</option>
        <option value="kn">Kannada</option>
        <option value="ml">Malayalam</option>
        <option value="mr">Marathi</option>
        <option value="gu">Gujarati</option>
        <option value="pa">Punjabi</option>
        <option value="bn">Bengali</option>
        <option value="or">Odia</option>
        <option value="as">Assamese</option>
        <option value="ur">Urdu</option>
    </select>
    
    <br>

    <button id="speakBtn">ðŸŽ¤ Speak Now</button>
    <br><br>
    <textarea id="textInput" placeholder="Or type your text here..."></textarea>
    <br>
    <button id="translateBtn">Translate Text</button>

    <div id="output">Original text will appear here...</div>
    <div id="translation">English translation will appear here...</div>

    <script>
        const speakBtn = document.getElementById("speakBtn");
        const translateBtn = document.getElementById("translateBtn");
        const languageSelect = document.getElementById("language");
        const textInput = document.getElementById("textInput");
        const output = document.getElementById("output");
        const translation = document.getElementById("translation");

        const langMap = {
            "en": "en-US",
            "hi": "hi-IN",
            "ta": "ta-IN",
            "te": "te-IN",
            "kn": "kn-IN",
            "ml": "ml-IN",
            "mr": "mr-IN",
            "gu": "gu-IN",
            "pa": "pa-IN",
            "bn": "bn-IN",
            "or": "or-IN",
            "as": "as-IN",
            "ur": "ur-IN"
        };

        const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
        if (SpeechRecognition) {
            const recognition = new SpeechRecognition();
            recognition.continuous = false;
            recognition.interimResults = false;

            recognition.onresult = (event) => {
                const spokenText = event.results[0][0].transcript;
                output.innerHTML = spokenText;
                textInput.value = spokenText;
                translateText(spokenText, languageSelect.value);
            };

            recognition.onerror = (event) => {
                output.innerHTML = "Error: " + event.error;
            };

            speakBtn.addEventListener("click", () => {
                const selectedLang = languageSelect.value;
                recognition.lang = langMap[selectedLang] || "en-US";
                recognition.start();
                output.innerHTML = "Listening...";
                translation.innerHTML = "Translating...";
            });
        } else {
            output.innerHTML = "Speech recognition not supported in this browser.";
        }

        translateBtn.addEventListener("click", () => {
            const text = textInput.value.trim();
            if (text) {
                output.innerHTML = text;
                translateText(text, languageSelect.value);
            }
        });

        async function translateText(text, lang) {
            try {
                const response = await fetch('http://127.0.0.1:5000/translate', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({text: text, lang: lang})
                });
                const data = await response.json();
                if (data.translatedText) {
                    translation.innerHTML = data.translatedText;
                } else {
                    translation.innerHTML = "Error: " + data.error;
                }
            } catch (err) {
                translation.innerHTML = "Error: " + err;
            }
        }
    </script>
</body>
</html>
